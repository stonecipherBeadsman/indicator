<!DOCTYPE html>
<html>

<head>
    <title></title>
    <script type="text/javascript">
    var hourlyDeviceTime = 54;
    var forceColor = false;
    var homeMode = true;
    var sleepTime = {
        backgroundColor: 'blue',
        textColor: 'yellow',
        description: 'Time to Sleep',
        nap: {
            hour: 12,
            minutes: 20,
            meridian: 'PM',
            description: 'Nap'
        },
        bed: {
            hour: 7,
            minutes: 5,
            meridian: 'PM',
            description: 'Bed'
        }
    };

    var eatTime = {
        backgroundColor: 'yellow',
        textColor: 'blue',
        description: 'Time to Eat',
        breakfast: {
            hour: 6,
            minutes: 15,
            meridian: 'AM',
            description: 'Breakfast'
        },
        secondBreakfast: {
            hour: 8,
            minutes: 1,
            meridian: 'AM',
            description: 'Second Breakfast'
        },
        lunch: {
            hour: 11,
            minutes: 20,
            meridian: 'AM',
            description: 'Lunch'
        },
        dinner: {
            hour: 4,
            minutes: 44,
            meridian: 'PM',
            description: 'Dinner'
        }
    };

    var bathTime = {
        backgroundColor: 'teal',
        textColor: 'pink',
        hour: 5,
        minutes: 44,
        meridian: 'PM',
        description: 'Bath'
    };

    var activityTime = {
        backgroundColor: 'pink',
        textColor: 'teal',
        hour: 9,
        minutes: 44,
        meridian: 'AM',
        description: 'Activity'
    };

    var readingTime = {
        backgroundColor: 'orange',
        textColor: 'blue',
        hour: 6,
        minutes: 44,
        meridian: 'PM',
        description: 'Read'
    };

    function setTextColor(color) {
        document.getElementById("servertime").setAttribute("style", "color:" + color);
    }

    function setBackgroundColor(color) {
        document.body.setAttribute("style", "background: " + color);
    }

    function setBackgroundToDefault(){
        setBackgroundColor('green');
        setTextColor('red');
        setMessage('');
    }

    function setMessage(text) {
        document.getElementById("message").innerHTML = text;
    }

    function getTextMessage(){
        return document.getElementById("message").innerHtml;
    }

    function getBackgroundColor() {
        return document.body.style.backgroundColor;
    }

    function keydown(evt) {
        if (evt.ctrlKey && evt.shiftKey && evt.keyCode === 83) {
            var givenValue = 'blue';
            if(forceColor){
                givenValue = 'off';
            }
            var promptInput = prompt("Input a color to change background,\nInput 'off' to allow the program to choose:", givenValue);
            if (promptInput === null || promptInput === "") {
                console.log('canceled');
            } else if(promptInput === 'off'){
                forceColor = false;
            } else if(promptInput === 'work'){
            	homeMode = false;
            } else if(promptInput === 'home'){
            	homeMode = true;
            } else {
                if (promptInput === sleepTime.backgroundColor) {
                    setTextColor(sleepTime.textColor);
                    setMessage(sleepTime.description);
                } else if (promptInput === eatTime.backgroundColor) {
                    setTextColor(eatTime.textColor);
                    setMessage(eatTime.description);
                } else if (promptInput === bathTime.backgroundColor) {
                    setTextColor(bathTime.textColor);
                    setMessage(bathTime.description);
                } else if (promptInput === activityTime.backgroundColor) {
                    setTextColor(activityTime.textColor);
                    setMessage(activityTime.description);
                } else if (promptInput === readingTime.backgroundColor) {
                    setTextColor(readingTime.textColor);
                    setMessage(readingTime.description);
                } else if (promptInput === sleepTime.backgroundColor) {
                    setTextColor(sleepTime.textColor);
                    setMessage(sleepTime.description);
                }
                setBackgroundColor(promptInput);
                forceColor = true;
                console.log(promptInput);
            }
        }
    }

    function homeSchedule(hours, minutes, meridian){
    	/*Reading Time Before Bed*/
	    if (hours === readingTime.hour &&
	        minutes >= readingTime.minutes &&
	        minutes <= readingTime.minutes + 10 &&
	        meridian === readingTime.meridian) {
	        if(getBackgroundColor() !== readingTime.backgroundColor ||
	            getTextMessage() !== readingTime.description){
	            setBackgroundColor(readingTime.backgroundColor);
	            setTextColor(readingTime.textColor);
	            setMessage(readingTime.description);
	        }
	        /*Nap Time*/
	    } else if (hours === sleepTime.nap.hour &&
	        minutes >= sleepTime.nap.minutes &&
	        minutes <= sleepTime.nap.minutes + (10 * 3) &&
	        meridian === sleepTime.nap.meridian) {
	        if(getBackgroundColor() !== sleepTime.backgroundColor ||
	            getTextMessage() !== sleepTime.nap.description){
	            setBackgroundColor(sleepTime.backgroundColor);
	            setTextColor(sleepTime.textColor);
	            setMessage(sleepTime.nap.description);
	        }
	        /*Bed Time*/
	    } else if (hours === sleepTime.bed.hour &&
	        minutes >= sleepTime.bed.minutes &&
	        minutes <= sleepTime.bed.minutes + (10 * 3) &&
	        meridian === sleepTime.bed.meridian) {
	        if(getBackgroundColor() !== sleepTime.backgroundColor ||
	            getTextMessage() !== sleepTime.bed.description){
	            setBackgroundColor(sleepTime.backgroundColor);
	            setTextColor(sleepTime.textColor);
	            setMessage(sleepTime.bed.description);  
	        }
	        /*Breakfast Time*/
	    } else if (hours === eatTime.breakfast.hour &&
	        minutes >= eatTime.breakfast.minutes &&
	        minutes <= eatTime.breakfast.minutes + (10 * 3) &&
	        meridian === eatTime.breakfast.meridian) {
	        if(getBackgroundColor() !== eatTime.backgroundColor ||
	            getTextMessage() !== eatTime.breakfast.description){
	            setBackgroundColor(eatTime.backgroundColor);
	            setTextColor(eatTime.textColor);
	            setMessage(eatTime.breakfast.description);                
	        }
	        
	        /*Second Breakfast Time*/
	    } else if (hours === eatTime.secondBreakfast.hour &&
	        minutes >= eatTime.secondBreakfast.minutes &&
	        minutes <= eatTime.secondBreakfast.minutes + (10 * 3) &&
	        meridian === eatTime.secondBreakfast.meridian) {
	        if(getBackgroundColor() !== eatTime.backgroundColor ||
	            getTextMessage() !== eatTime.secondBreakfast.description){
	            setBackgroundColor(eatTime.backgroundColor);
	            setTextColor(eatTime.textColor);
	            setMessage(eatTime.secondBreakfast.description);                
	        }
	        /*Lunch Time*/
	    } else if (hours === eatTime.lunch.hour &&
	        minutes >= eatTime.lunch.minutes &&
	        minutes <= eatTime.lunch.minutes + (10 * 3) &&
	        meridian === eatTime.lunch.meridian) {
	        if(getBackgroundColor() !== eatTime.backgroundColor ||
	            getTextMessage() !== eatTime.lunch.description){
	            setBackgroundColor(eatTime.backgroundColor);
	            setTextColor(eatTime.textColor);
	            setMessage(eatTime.lunch.description);
	        }
	        
	        /*Dinner Time*/
	    } else if (hours === eatTime.dinner.hour &&
	        minutes >= eatTime.dinner.minutes &&
	        minutes <= eatTime.dinner.minutes + 10 &&
	        meridian === eatTime.dinner.meridian) {
	        if(getBackgroundColor() !== eatTime.backgroundColor ||
	            getTextMessage() !== eatTime.dinner.description){
	            setBackgroundColor(eatTime.backgroundColor);
	            setTextColor(eatTime.textColor);
	            setMessage(eatTime.dinner.description);
	        }
	        /*Activity Time*/
	    } else if (hours === activityTime.hour &&
	        minutes >= activityTime.minutes &&
	        minutes <= activityTime.minutes + 10 &&
	        meridian === activityTime.meridian) {
	        if(getBackgroundColor() !== activityTime.backgroundColor ||
	            getTextMessage() !== activityTime.description){
	            setBackgroundColor(activityTime.backgroundColor);
	            setTextColor(activityTime.textColor);
	            setMessage(activityTime.description);
	        }
	        /*Bath Time*/
	    } else if (hours === bathTime.hour &&
	        minutes >= bathTime.minutes &&
	        minutes <= bathTime.minutes + 10 &&
	        meridian === bathTime.meridian) {
	        if(getBackgroundColor() !== bathTime.backgroundColor ||
	            getTextMessage() !== bathTime.description){
	            setBackgroundColor(bathTime.backgroundColor);
	            setTextColor(bathTime.textColor);
	            setMessage(bathTime.description);                
	        }
	     /*Default Case*/
	 	} else {
	         if (getBackgroundColor() !== 'green') {
	         	setBackgroundToDefault();
	         }
	     }
    }

    document.onkeydown = keydown;

    function displaytime(isTest, hoursTest, minutesTest, secondsTest, meridianTest) {

        var currenttime = Date.now();
        var localTime = new Date(currenttime).toLocaleTimeString();
        var hours = 0;
        var minutes = 0;
        var seconds = 0;
        var meridian = '';
        if (!isTest) {
            hours = parseInt(localTime.split(':')[0].split(' ')[0]);
            minutes = parseInt(localTime.split(':')[1].split(' ')[0]);
            seconds = parseInt(localTime.split(':')[2].split(' ')[0]);
            meridian = localTime.split(':')[2].split(' ')[1];
        } else {
            hours = hoursTest;
            minutes = minutesTest;
            seconds = secondsTest;
            meridian = meridianTest;
        }

        console.log('hours', hours, '\nminutes', minutes, '\nseconds', seconds, '\nmeridian', meridian);
        document.getElementById("servertime").innerHTML = localTime;
        //certain time chunck of the hour
        if(!forceColor){
            if (minutes >= hourlyDeviceTime) { //happens every hour
                if (getBackgroundColor() !== 'red') {
                    setBackgroundColor('red');
                    setTextColor('green');
                    setMessage('');
                }
            } else if (minutes === 0) {
                if (seconds % 2 === 0) {
                    setBackgroundColor('white');
                    setTextColor('black');
                    setMessage('');
                } else {
                    setBackgroundColor('black');
                    setTextColor('white');
                    setMessage('');
                }
            } else if(homeMode){
                	homeSchedule(hours, minutes, meridian);
	        }
            /*Default Case*/
            else {
                if (getBackgroundColor() !== 'green') {
                	setBackgroundToDefault();
                }
            }
        }
    }

    //window.open('https://www.youtube.com/watch?v=kdNpQ2R6C5s', '_blank', 'location=yes,height=570,width=520,scrollbars=yes,status=yes');

    window.onload = function() {
        /*TESTS*/
        //setInterval("displaytime(true, 6, 15, 0, 'AM')", 1000);
        //setInterval("displaytime(true, 8, 2, 0, 'AM')", 1000);
        //setInterval("displaytime(true, 9, 44, 0, 'AM')", 1000);
        //setInterval("displaytime(true, 11, 26, 0, 'AM')", 1000);
        //setInterval("displaytime(true, 12, 26, 0, 'PM')", 1000);
        //setInterval("displaytime(true, 4, 46, 0, 'PM')", 1000);
        //setInterval("displaytime(true, 5, 45, 0, 'PM')", 1000);
        //setInterval("displaytime(true, 6, 45, 0, 'PM')", 1000);
        //setInterval("displaytime(true, 7, 35, 0, 'PM')", 1000);
        /*Main Function Call*/
        setInterval("displaytime()", 1000);
    }
    </script>
</head>

<body style="background: white">
    <b style="font-size: 70px; font-family: monospace; text-align: center"><p id="servertime"></p></b>
    <div>
        <b style="font-size: 60px; font-family: monospace; text-align: center"><p id="message"></p></b>
    </div>
</body>

</html>